<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Incremento salarial oficios empleados</h1>
    <label>Seleccione un oficio</label>
    <select id="listaoficios"></select>
   
    <hr>
    <label>Incremento salarial</label>
    <input type="number" id="cajaincremento">
    <hr>
    <button type="button" id="botonincrementar">Incrementar salario</button>
    <hr>
    <table id="tabla" border="1">
        <thead>
            <tr>
                <td>Apellido</td>
                <td>Oficio</td>
                <td>Salario</td>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <script src="js/jquery-3.6.1.min.js"></script>
    <script>
    var url="apiempleadosaction.azurewebsites.net";
        $(document).ready(function(){
        cargarOficio();
        // var opcion="<option value=3>"+"DIRECTOR"+"</option>";
        // $("#listaoficios").append(opcion);
            var boton=$("#botonincrementar");
            boton.click(function(){
                var valor= $("#listaoficios").text();
                //console.log(valor);
                var input=$("#cajaincremento");
                var incremento = parseInt(input.val());
                var request ="/api/Empleados/IncrementarSalarioOficios/"+valor+"/"+incremento
                console.log(url+request);
                $.ajax({
                    "url":url+request,
                    "method":"PUT",
                  //  "data":"datos",
                    "contentType":"application/json",
                    success:function(){

                        $.each(data,function(index,oficio){

                        var fila=$("<tr>")
                        var col1=$("<td>"+oficio.apellido+"</td>")
                        var col2=$("<td>"+oficio.oficio+"</td>")
                        var col3=$("<td>"+oficio.salario+"</td>")

                        fila.append(col1);
                        fila.append(col2);
                        fila.append(col3);
                        $("#tabla").append(fila);
                    });
                    }
                })
            })
        })
        function cargarOficio(){
            $("#listaoficios").html("");
                var request="/api/Empleados/GetOficios/oficios";
                console.log(url+request);
               
                

                //no se realiza el get correctamente por alg√∫n motivo
                // url+request si funciona en Insomnia
                $.ajax({
                "url":url+request,
                "method":"GET",
                "dataType":"json",
                success : function(data){  
                    console.log("entro")
                $.each(data,function(index,oficio){
                    //para cada oficio creo una etiqueta option 
                    var opcion="<option>"+oficio+"<option>"
                        //le agrego la nueva opcion al select
                        $("#listaoficios").append(opcion);
                             //console.log(oficio);
                    })

                }
             });
        }
    </script>
</body>
</html>
<!-- apiempleadosaction.azurewebsites.net/api/Empleados/GetOficios/oficios
apiempleadosaction.azurewebsites.net/api/Empleados/GetOficios/oficios -->